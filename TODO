subst-site?
<------>location /asgek {
<------><------>rewrite ^/asgek/(.*)$ /$1 break;
<------><------>proxy_pass http://devel.etersoft.ru:44180;
<------><------>include include/trans-proxy.conf;


http://wiki.nginx.org/Pitfalls#Server_Name

        public static function detectProtocol() {
                if ( ( isset( $_SERVER['HTTPS'] ) && $_SERVER['HTTPS'] == 'on' ) ||
                        ( isset( $_SERVER['HTTP_X_FORWARDED_PROTO'] ) &&
                        $_SERVER['HTTP_X_FORWARDED_PROTO'] == 'https' ) ) {
                        return 'https';
                } else {
                        return 'http';
                }
        }
